#Broadcast version of SalomoneRossiBergamasca
#Broadcast Skeleton for Sonic Pi
#coded by Robin Newman,Mar 2021
#utilises script broadcastOSC.py
use_debug false
use_cue_logging false
use_osc_logging false
titlecode="15 Salomone Rossi Bergamasca"
use_osc "localhost",8000
computer=get(:computer) #this computer number
computer = 1 if computer == nil #use 1 if computer: not specified

#qt is scale factor for amplitude. Set using :attentuate value
qt=get(:attenuate)
qt=1 if (qt == nil ) #in case attenuate has not been set
qt=[[qt,0].max,1].min

st=0 #start section of multi tempo music
#set_audio_latency! 234 #adjust for latency of computer relative to the others #this value for Mac
#play data sustain and release fractions and synth for each part
s=(ring 0.95,0.95,1,1,1);r=(ring 0.05,0.05,1,1,1);synth=(ring "sine","sine","pluck","pluck","pluck") #parameters for the run. (s,r sustain release fractions)

amp=(ring 0.3,0.3,1,1,1)

define :decode do |dl|#return selected channels in an integer array
    puts "entry",dl #print current entry
  if dl.is_a? Numeric
    return Array(dl)
  else
    return dl[1..-2].split(",").map {|str| str.to_i}
  end
end

define :bosc do |num,nv,dv,s,r,synth,tempo,amp,cueval,tr=0| #cueval used to separate tempo sections
  nv.length.times do
    tick
    if nv.look.respond_to?(:each) #deal with chords (played without gap between notes)
      nv.look.each do |v|
        osc "/triggerBroadcast", num, note(v)+tr,(dv.look),s,r,synth,tempo,amp
      end
    else
      if nv.look!=:r #ignore rests
        osc "/triggerBroadcast", num, note(nv.look)+tr,(dv.look),s,r,synth,tempo,amp
      end
    end
     with_bpm tempo do;sleep dv.look;end
  end
  cue cueval
end

with_fx :reverb,room: 0.8,mix: 0.6 do #add some reverb to playback
  
  live_loop :pl do
    use_real_time
    b = sync"/osc*/broadcast"
    if b[0]==99 #99 is channel code to receive channel data lists
      op=[] #start output list
      b.each do |x| #check each element and process using decode
        op << (decode x)
      end
      #op now contains all machine channel list with array elements for each machine
      op[computer]=["none found"] if op[computer]==nil
      set :channel,op[computer]
    elsif b[0]==10
      sleep 2
      osc_send "localhost",4560,"/playnext",b[1] #send info back to calling buffer
      sleep 0.2
      stop
    end
    channel=get(:channel)
    puts "title code #{titlecode}: tempo #{b[6]}"
    puts "channels for computer no #{computer} #{channel}"
    if channel.include? b[0]
      use_synth b[5].to_sym
      use_bpm b[6]
      play b[1],sustain: b[2]*b[3],release: b[2]*b[4],amp: b[7]
    end
  end
end

########## Allocate channels to be played by each computer here
#computer number                1      2     3     4     5     6     7     8
osc "/triggerBroadcast",99,    0,     0,    3,    4,    2,    2,    1,    1
#osc "/triggerBroadcast",99,    "[0,3,4]",     9,    9,    9,    "[1,2]",    2,    1,    1

a1=[]
b1=[]
a1[0]=[:r,:D6,:D6,:C6,:E6,:D6,:C6,:B5,:D6,:C6,:B5,:A5,:G5,:A5,:B5,:C6,:A5,:G5,:D6,:G6,:F6,:E6,:E6,:D6,:C6,:B5,:A5,:B5,:C6,:D6,:C6,:B5,:A5,:G5,:G5,:A5,:G5,:D6,:E6,:F6,:G6,:F6,:E6,:D6,:C6,:B5,:A5,:B5,:C6,:D6,:C6,:B5,:A5,:B5,:C6,:D6,:E6,:F6,:G6,:F6,:E6,:C6,:D6,:E6,:F6,:G6,:E6,:Fs6,:G6,:Fs6,:G6,:Fs6,:E6,:Fs6,:G6,:D6,:G6,:F6,:E6,:E6,:D6,:C6,:B5,:G5,:A5,:B5,:G5,:D6,:B5,:C6,:B5,:A5,:G5,:A5,:G5,:D6,:B5,:C6,:D6,:E6,:F6,:D6,:E6,:C6,:D6,:E6,:F6,:G6,:E6,:Fs6,:D6,:E6,:Fs6,:G6,:A6,:Fs6,:G6,:G5,:A5,:B5,:C6,:D6,:B5,:C6,:F5,:G5,:A5,:B5,:C6,:A5,:B5,:C6,:D6,:E6,:D6,:C6,:B5,:A5,:G5,:A5,:G5,:G6,:D6,:G6,:D6,:E6,:G6,:Fs6,:E6,:Fs6,:G6,:D6,:A5,:B5,:G5,:A5,:B5,:C6,:A5,:B5,:G5,:A5,:B5,:A5,:G5,:r,:G6,:F6,:E6,:D6,:C6,:B5,:A5,:G5,:A5,:G5,:Fs5,:G5,:A5,:B5,:C6,:A5,:B5,:A5,:B5,:C6,:D6,:C6,:D6,:B5,:C6,:B5,:A5,:B5,:C6,:B5,:C6,:A5,:B5,:C6,:D6,:E6,:D6,:C6,:B5,:A5,:G5,:A5,:G5,:A5,:B5,:G5,:G6,:F6,:E6,:D6,:G6,:E6,:E6,:Fs6,:G6,:Fs6,:G6,:F6,:E6,:D6,:E6,:F6,:E6,:D6,:C6,:D6,:E6,:F6,:G6,:Fs6,:G6,:Fs6,:G6,:Fs6,:E6,:Fs6,:G6,:D6,:C6,:D6,:E6,:D6,:D6,:E6,:D6,:E6,:F6,:G6,:G6,:Fs6,:E6,:Fs6,:G6,:Fs6,:Fs6,:G6,:F6,:G6,:A6,:G6,:G6,:A6,:G6,:A6,:B6,:A6,:A6,:G6,:F6,:G6,:A6,:G6,:E6,:Fs6,:E6,:Fs6,:G6,:Fs6,:G6,:A6,:Fs6,:G6,:D6,:G5,:G6,:E6,:C6,:A5,:D6,:G5,:C6,:A5,:D6,:B5,:E6,:C6,:B5,:A5,:B5,:B5,:A5,:B5,:C6,:D6,:B5,:C6,:D6,:E6,:F6,:G6,:F6,:E6,:G6,:Fs6,:E6,:Fs6,:E6,:D6,:E6,:Fs6,:G6,:A6,:Fs6,:G6,:D6,:E6,:F6,:G6,:B5,:C6,:D6,:E6,:G6,:F6,:E6,:F6,:D6,:E6,:F6,:E6,:D6,:C6,:B5,:D6,:C6,:B5,:A5,:G5,:A5,:G5,:G6,:F6,:E6,:E6,:D6,:C6,:B5,:D6,:C6,:B5,:A5,:G5,:Fs5,:G5,:A5,:G5,:G6,:E6,:F6,:D6,:E6,:C6,:D6,:B5,:E6,:C6,:D6,:B5,:C6,:A5,:B5,:G5,:D6,:B5,:C6,:A5,:B5,:G5,:A5,:Fs5,:B5,:G5,:A5,:F5,:G5,:E5,:F5,:D5,:E5,:F5,:G5,:E5,:Fs5,:G5,:A5,:G5,:Fs5,:G5,:Fs5,:G5,:A5,:B5,:C6,:A5,:G5,:B5,:A5,:B5,:C6,:D6,:C6,:B5,:C6,:D6,:E6,:F6,:D6,:E6,:C6,:E6,:D6,:C6,:B5,:A5,:G5,:Fs5,:G5,:A5,:B5,:C6,:A5,:B5,:D6,:C6,:B5,:A5,:G5,:F5,:E5,:E6,:D6,:C6,:B5,:A5,:G5,:A5,:G5,:A5,:B5,:C6,:D6,:C6,:B5,:A5,:B5,:B5,:C6,:D6,:G6,:F6,:E6,:G6,:F6,:E6,:D6,:C6,:B5,:A5,:B5,:C6,:D6,:C6,:B5,:B5,:C6,:D6,:C6,:B5,:C6,:A5,:B5,:C6,:B5,:A5,:B5,:C6,:D6,:E6,:F6,:G6,:E6,:Fs6,:G6,:Fs6,:G6,:Fs6,:E6,:Fs6,:G6,:B5,:A5,:B5,:C6,:D6,:B5,:C6,:D6,:E6,:F6,:G6,:F6,:E6,:D6,:C6,:B5,:A5,:G5,:Fs5,:G5,:A5,:B5,:C6,:A5,:B5,:C6,:D6,:C6,:B5,:C6,:D6,:B5,:C6,:B5,:A5,:G5,:A5,:B5,:C6,:A5,:B5,:C6,:D6,:E6,:F6,:G6,:E6]
b1[0]=[2.0,1.0,1.0,1.0,1.0,1.5,0.5,2.0,1.0,0.5,0.5,1.0,0.5,0.5,0.5,0.5,1.0,2.0,1.0,0.5,0.5,1.0,1.0,0.5,0.5,0.5,0.5,1.5,0.5,0.5,0.5,0.5,0.5,1.0,1.0,2.0,2.0,0.5,0.25,0.25,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.25,0.25,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.25,0.25,0.5,0.5,0.5,0.25,0.25,0.25,0.25,0.25,0.25,0.5,0.25,0.25,0.25,0.25,0.25,0.25,2.0,1.0,0.5,0.5,1.0,1.0,1.5,0.5,1.0,0.5,0.5,0.5,0.5,0.5,0.5,1.0,1.0,0.5,0.5,1.0,2.0,0.5,0.25,0.25,0.25,0.25,0.25,0.25,0.5,0.25,0.25,0.25,0.25,0.25,0.25,0.5,0.25,0.25,0.25,0.25,0.25,0.25,0.5,0.25,0.25,0.25,0.25,0.25,0.25,0.5,0.25,0.25,0.25,0.25,0.25,0.25,0.5,0.25,0.25,0.25,0.25,0.25,0.25,0.5,0.5,1.0,2.0,0.5,0.5,0.5,0.5,1.0,1.0,0.5,0.5,1.0,0.5,1.0,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,1.0,2.0,2.0,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.5,0.25,0.25,0.25,0.25,0.25,0.25,0.5,0.5,0.25,0.25,0.25,0.25,2.0,0.5,0.25,0.25,0.5,0.5,1.0,1.0,0.5,1.0,0.5,0.5,0.25,0.25,0.5,0.5,0.5,0.25,0.25,0.5,0.5,0.5,0.5,1.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,2.0,0.25,0.25,0.25,0.25,0.5,0.5,0.25,0.25,0.25,0.25,0.5,0.5,0.25,0.25,0.25,0.25,0.5,0.5,0.25,0.25,0.25,0.25,0.5,0.5,0.25,0.25,0.25,0.25,0.5,0.5,0.25,0.25,0.25,0.25,0.5,0.5,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,2.0,0.5,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.5,0.5,1.0,1.0,0.5,1.0,2.0,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.5,0.25,0.25,0.25,0.25,0.25,0.25,0.5,0.5,1.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.5,0.5,1.0,2.0,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,1.0,0.25,0.25,0.25,0.25,0.5,0.5,1.0,1.0,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.5,0.5,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.5,0.25,0.25,0.25,0.25,0.25,0.25,0.5,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.5,0.5,0.75,0.25,1.0,2.0,0.5,0.5,0.5,0.25,0.25,0.5,0.25,0.25,0.25,0.25,0.25,0.25,0.5,0.5,0.5,0.25,0.25,0.5,0.25,0.25,0.5,0.25,0.25,0.5,0.25,0.25,0.5,0.25,0.25,0.5,0.25,0.25,0.25,0.25,0.25,0.25,0.5,0.25,0.25,0.25,0.25,0.25,0.25,2.0,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.5,0.25,0.25,0.25,0.25,0.25,0.25]
a1[1]=[:Fs6,:G6,:Fs6,:G6,:Fs6,:G6,:Fs6,:E6,:Fs6,:G6,:r]
b1[1]=[0.5,0.25,0.25,0.25,0.25,0.125,0.125,0.125,0.125,2.0,2.0]
c1=[100,80]
 in_thread do
   for i in st..a1.length-1
     in_thread do
       bosc 0,a1[i],b1[i],s[0],r[0],synth[0],c1[i],amp[0]*qt,:cont0,-2
     end
     sync :cont0
   end
     sleep 0.2
   osc "/triggerBroadcast",10,"finished15" #kill player for first part in program above
 end

a2=[]
b2=[]
a2[0]=[:r,:B5,:B5,:E5,:G5,:Fs5,:G5,:B5,:A5,:G5,:Fs5,:G5,:Fs5,:G5,:B5,:C6,:D6,:B5,:C6,:B5,:A5,:G5,:Fs5,:G5,:A5,:D5,:D6,:C6,:B5,:A5,:G5,:F5,:E5,:F5,:G5,:Fs5,:G5,:B5,:B5,:C6,:B5,:A5,:G5,:Fs5,:E5,:Fs5,:G5,:D6,:C6,:B5,:A5,:B5,:C6,:B5,:A5,:B5,:A5,:B5,:A5,:G5,:A5,:B5,:B5,:A5,:B5,:B5,:C6,:G5,:Fs5,:G5,:A5,:D6,:C6,:B5,:A5,:G5,:C6,:F6,:D6,:E6,:F6,:G6,:E6,:Fs6,:G6,:Fs6,:G6,:B5,:G5,:A5,:B5,:C6,:D6,:B5,:C6,:E6,:D6,:C6,:B5,:A5,:G5,:A5,:Fs5,:G5,:A5,:B5,:C6,:A5,:B5,:A5,:B5,:C6,:D6,:C6,:B5,:A5,:G5,:A5,:B5,:C6,:B5,:A5,:G5,:F5,:E5,:F5,:G5,:Fs5,:G5,:E5,:Fs5,:G5,:Fs5,:G5,:B5,:B5,:C6,:G5,:C6,:G5,:A5,:A5,:D6,:A5,:B5,:A5,:G5,:F5,:E5,:F5,:G5,:E5,:Fs5,:G5,:Fs5,:G5,:D6,:C6,:B5,:A5,:G5,:F5,:E5,:D5,:E5,:G5,:Fs5,:G5,:A5,:G5,:Fs5,:G5,:A5,:Fs5,:G5,:F5,:G5,:A5,:B5,:A5,:B5,:G5,:A5,:G5,:F5,:G5,:A5,:G5,:A5,:F5,:G5,:A5,:B5,:C6,:B5,:A5,:G5,:Fs5,:G5,:Fs5,:G5,:B5,:C6,:B5,:C6,:B5,:A5,:G5,:C6,:A5,:D6,:C6,:B5,:A5,:D6,:B5,:A5,:B5,:G5,:A5,:G5,:A5,:B5,:C6,:B5,:A5,:G5,:A5,:B5,:A5,:B5,:A5,:G5,:A5,:B5,:B5,:A5,:B5,:C6,:B5,:B5,:C6,:B5,:C6,:D6,:E6,:E6,:A5,:G5,:A5,:B5,:A5,:A5,:B5,:A5,:B5,:C6,:B5,:B5,:C6,:B5,:C6,:D6,:C6,:A5,:B5,:A5,:B5,:C6,:B5,:C6,:B5,:A5,:G5,:A5,:B5,:A5,:A5,:B5,:B5,:B5,:E6,:C6,:C6,:A5,:B5,:G5,:A5,:F5,:G5,:G5,:E5,:Fs5,:G5,:Fs5,:G5,:D6,:C6,:B5,:A5,:B5,:G5,:A5,:B5,:C6,:B5,:A5,:G5,:C6,:B5,:A5,:G5,:Fs5,:G5,:A5,:B5,:C6,:A5,:B5,:A5,:B5,:A5,:G5,:A5,:B5,:C6,:G5,:Fs5,:G5,:Fs5,:G5,:B5,:C6,:D6,:G5,:A5,:G5,:Fs5,:G5,:A5,:D5,:G5,:A5,:B5,:E5,:A5,:G5,:Fs5,:D5,:E5,:A5,:G5,:Fs5,:G5,:B5,:A5,:B5,:A5,:B5,:C6,:B5,:A5,:G5,:Fs5,:G5,:Fs5,:D6,:B5,:C6,:A5,:B5,:G5,:A5,:F5,:G5,:A5,:E5,:A5,:G5,:Fs5,:G5,:D6,:C6,:B5,:A5,:B5,:A5,:G5,:A5,:B5,:C6,:D6,:B5,:C6,:E6,:C6,:B5,:A5,:G5,:Fs5,:G5,:A5,:G5,:Fs5,:G5,:A5,:Fs5,:G5,:A5,:B5,:C6,:D6,:B5,:C6,:C6,:G5,:E5,:Fs5,:E5,:D5,:E5,:G5,:Fs5,:G5,:D6,:C6,:B5,:C6,:E6,:D6,:C6,:B5,:A5,:G5,:Fs5,:G5,:Fs5,:G5,:D6,:C6,:B5,:A5,:G5,:A5,:C6,:B5,:A5,:G5,:F5,:G5,:G6,:F6,:E6,:D6,:C6,:B5,:A5,:G5,:A5,:G5,:D6,:C6,:B5,:A5,:B5,:G5,:A5,:B5,:C6,:D6,:E6,:D6,:C6,:B5,:A5,:G5,:Fs5,:G5,:A5,:G5,:Fs5,:G5,:A5,:Fs5,:G5,:A5,:B5,:A5,:G5,:A5,:B5,:G5,:A5,:B5,:C6,:B5,:A5,:G5,:A5,:F5,:G5,:A5,:B5,:G5,:C6,:B5]
b2[0]=[2.0,1.0,1.0,1.0,2.0,1.0,2.0,1.0,0.5,0.5,1.0,2.0,1.0,2.0,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,1.0,0.5,0.5,1.0,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,2.0,1.0,2.0,1.0,1.0,0.5,0.5,0.5,0.5,0.5,0.5,1.0,1.0,0.5,0.5,0.5,0.5,1.0,1.0,1.0,0.5,0.25,0.25,0.25,0.25,0.25,0.25,2.0,0.5,0.5,0.5,0.5,1.0,1.0,0.5,1.0,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,1.0,0.5,2.0,0.5,0.25,0.25,0.25,0.25,0.25,0.25,0.5,0.25,0.25,0.25,0.25,0.25,0.25,0.5,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.5,0.25,0.25,0.25,0.25,0.25,0.25,0.5,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.5,1.0,0.5,2.0,1.0,1.0,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,1.0,1.0,1.0,1.0,0.5,0.5,0.5,0.5,0.5,1.0,0.5,2.0,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,1.0,1.0,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.5,0.25,0.25,0.25,0.25,0.25,0.25,0.5,1.0,0.5,2.0,0.5,1.0,0.5,0.5,0.25,0.25,0.5,0.5,0.25,0.25,0.25,0.25,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.25,0.25,0.25,0.25,0.25,0.25,2.0,0.25,0.25,0.25,0.25,0.5,0.5,0.25,0.25,0.25,0.25,0.5,0.5,0.25,0.25,0.25,0.25,0.5,0.5,0.25,0.25,0.25,0.25,0.5,0.5,0.25,0.25,0.25,0.25,0.5,0.5,0.25,0.25,0.25,0.25,0.5,0.25,0.25,0.25,0.25,0.25,0.25,0.5,0.5,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.5,0.5,0.5,1.0,0.5,2.0,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.5,0.25,0.25,0.5,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.75,0.25,0.5,0.5,0.5,1.0,0.5,1.0,1.0,0.5,1.0,0.5,2.0,1.0,0.5,0.5,0.5,0.5,1.0,1.0,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,1.0,1.0,0.5,0.5,0.5,1.0,0.5,2.0,0.75,0.25,0.5,0.25,0.25,0.5,0.5,0.5,0.5,0.5,1.0,0.5,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,1.0,0.5,0.5,1.0,2.0,1.0,1.0,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.5,0.5,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.5,0.5,0.5,0.5,0.5,0.5,1.0,0.5,0.5,0.5,1.0,0.5,2.0,0.5,1.0,0.5,0.5,0.25,0.25,0.25,0.25,0.25,0.25,0.5,1.0,0.5,0.5,0.25,0.25,0.5,0.25,0.25,0.5,0.25,0.25,0.5,0.25,0.25,0.5,0.25,0.25,0.25,0.25,0.25,0.25,0.5,0.5,1.0,2.0,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.5,0.5]
a2[1]=[:A5,:B5,:A5,:B5,:A5,:B5,:A5,:G5,:A5,:B5,:r]
b2[1]=[0.5,0.25,0.25,0.25,0.25,0.125,0.125,0.125,0.125,2.0,2.0]
c2=[100,80]
in_thread do
   for i in st..a2.length-1
     in_thread do
       bosc 1,a2[i],b2[i],s[1],r[1],synth[1],c2[i],amp[1]*qt,:cont1,-2
     end
     sync :cont1
   end
 end

a3=[]
b3=[]
a3[0]=[:r,[:B3,:G4],[:B3,:G4],[:G3,:C4,:G4],:G4,:Fs4,[:B3,:G4],[:G3,:B3,:G4],:Fs4,:G4,:Fs4,[:D3,:G3,:B3,:G4],:G4,[:E4,:G4],[:C4,:E4,:G4],[:A3,:D4],:r,[:B3,:D4],[:G3,:D4],[:G3,:D4],[:G3,:C4,:G4],:G4,:Fs4,[:G3,:B3,:G4],[:B3,:G4],[:G3,:B3,:G4],[:G3,:C4,:E4],[:A3,:D4,:Fs4],[:B3,:G4],[:G3,:B3,:G4],[:B3,:G4],[:G3,:B3,:G4],[:G3,:C4,:E4],[:A3,:D4,:Fs4],[:G3,:B3,:G4],[:D4,:G4],[:C4,:E4],:D4,[:G3,:B3,:G4],[:D4,:G4],[:C4,:E4],[:C4,:E4],:Fs4,[:G3,:B3,:G4],[:B3,:G4],[:G3,:B3,:G4],[:G3,:C4,:E4],[:A3,:C4,:E4],[:A3,:D4,:Fs4],[:A3,:D4,:Fs4],[:G3,:B3,:G4],[:B3,:G4],[:C4,:A4],[:E4,:G4],:Fs4,:G4,:Fs4,[:G3,:B3,:G4],[:B3,:G4],[:G3,:B3,:G4],[:G3,:C4,:E4],[:A3,:D4,:Fs4],:B3,:A3,:G3,:F3,[:G3,:C4,:E4],[:A3,:D4,:Fs4],[:G3,:B3,:G4],[:B3,:G4],[:G3,:B3,:G4],[:G3,:C4,:E4],[:A3,:D4,:Fs4],[:B3,:G4],[:C4,:A4],[:E4,:G4],:Fs4,:G4,:Fs4,[:G3,:B3,:G4],[:B3,:G4],[:G3,:C4,:E4],[:A3,:D4,:Fs4],[:B3,:G4],[:C4,:A4],[:G3,:C4,:G4],:G4,:Fs4,[:G3,:B3,:G4],[:B3,:G4],[:B3,:G4],[:G3,:C4,:G4],[:G3,:C4,:G4],[:A3,:D4,:Fs4],[:A3,:D4,:Fs4],[:B3,:G4],[:B3,:G4],[:C4,:A4],[:C4,:A4],[:E4,:G4],:Fs4,:G4,:Fs4,[:G3,:B3,:G4],[:B3,:G4],[:B3,:G4],[:G3,:C4,:G4],[:G3,:C4,:G4],[:C4,:E4,:A4],[:A3,:D4,:Fs4],[:B3,:G4],[:G3,:B3,:G4],[:A3,:C4],[:A3,:D4],[:C4,:E4],:G4,:Fs4,[:G3,:B3,:G4],[:D4,:G4],[:C4,:E4],:D4,[:G3,:B3,:G4],[:D4,:G4],[:C4,:E4],[:C4,:E4],:Fs4,[:G3,:B3,:G4],:r,:G3,:A3,:B3,:E4,:D4,:D4,:C4,:Fs4,:Fs4,[:G3,:B3,:G4],[:B3,:G4],[:G3,:B3,:G4],[:G3,:C4,:E4],[:A3,:D4,:Fs4],[:D4,:G4],[:C4,:E4],:Fs4,:G4,:Fs4,[:G3,:B3,:G4],[:B3,:G4],[:G3,:B3,:G4],[:G3,:C4,:G4],[:G3,:C4,:G4],[:A3,:D4,:Fs4],[:B3,:G4],[:G3,:B3,:G4],[:C4,:E4],:D4,:E4,:G4,[:G3,:B3,:G4],[:B3,:G4],[:B3,:G4],[:G3,:C4,:E4],[:G3,:C4,:E4],:Fs4,:G4,[:B3,:G4],[:B3,:G4],[:C4,:A4],[:E4,:G4],:Fs4,:G4,:Fs4,[:G3,:B3,:G4],[:B3,:G4],[:B3,:G4],[:G3,:C4,:G4],[:G3,:C4,:G4],[:A3,:D4,:Fs4],[:A3,:D4,:Fs4],[:B3,:G4],[:B3,:G4],[:C4,:A4],[:C4,:A4],[:E4,:G4]]
b3[0]=[2.0,1.0,1.0,2.0,1.0,1.0,2.0,2.0,1.0,2.0,1.0,2.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,2.0,1.0,1.0,2.0,1.0,1.0,2.0,2.0,1.0,1.0,1.0,1.0,2.0,2.0,2.0,2.0,2.0,2.0,1.0,1.0,2.0,2.0,2.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,2.0,0.5,1.0,0.5,2.0,1.0,1.0,2.0,2.0,1.0,1.0,1.0,1.0,2.0,2.0,2.0,1.0,1.0,2.0,2.0,2.0,2.0,2.0,0.5,1.0,0.5,2.0,2.0,2.0,2.0,2.0,2.0,2.0,1.0,1.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,0.5,1.0,0.5,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,1.0,1.0,2.0,2.0,2.0,2.0,1.0,1.0,2.0,2.0,2.0,2.0,0.5,0.5,0.5,0.5,2.0,2.0,2.0,2.0,2.0,2.0,2.0,1.0,1.0,2.0,2.0,2.0,2.0,1.0,2.0,1.0,2.0,1.0,1.0,1.0,1.0,2.0,1.0,1.0,2.0,2.0,0.5,1.5,2.0,1.0,1.0,1.0,1.0,0.5,1.5,1.0,1.0,2.0,2.0,0.5,1.0,0.5,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0]
a3[1]=[[:A3,:D4,:Fs4],[:D3,:G3,:B3,:G4],:r]
b3[1]=[2.0,2.0,2.0]
c3=[100,80]
in_thread do
   for i in st..a3.length-1
     in_thread do
       bosc 2,a3[i],b3[i],s[2],r[2],synth[2],c3[i],amp[2]*qt,:cont2,-2
     end
     sync :cont2
   end
 end

a4=[]
b4=[]
a4[0]=[:r,:G3,:G3,:C3,[:D3,:A3,:D4],:G3,:G2,:D3,:E3,:C3,:D3,:G2,:G3,:A3,:B3,:G3,:C4,:C3,:D3,:E3,:Fs3,:G3,:G2,:A2,:B2,:B2,:C3,:D3,:E3,[:D3,:A3,:D4],:G2,:G3,:G2,:C3,:D3,:G3,:G2,:G3,:G2,:C3,:D3,:G2,:G3,:F3,:E3,:D3,:C3,:D3,:E3,:C3,:D3,:C3,:B2,:A2,:G2,:G3,:F3,:E3,:F3,:D3,:G3,:C3,:A2,:B2,:G2,:D3,:B2,:C3,:D3,:G2,:G3,:G2,:C3,:A2,:D3,:D3,:G2,:G3,:F3,:E3,:C3,[:D3,:A3,:D4],:G2,:G3,:G2,:C3,:E3,:D3,:G3,:F3,:E3,:D3,:C3,:E3,:D3,:G2,:G3,:G2,:C3,:E3,:D3,:G3,:F3,:E3,:C3,[:D3,:A3,:D4],:G2,:G3,:C3,:D3,:G3,:F3,:C3,:D3,:E3,[:D3,:A3,:D4],:G2,:G3,:G3,:C3,:C3,:D3,:D3,:G3,:G3,:F3,:F3,:E3,:E3,:C3,[:D3,:D4],:G2,:G3,:G3,:C3,:C3,:A2,:D3,:G3,:E3,:F3,:D3,:E3,:C3,[:D3,:A3,:D4],:G2,:G3,:F3,:E3,:D3,:C3,:D3,:E3,:C3,:D3,:C3,:B2,:A2,:G2,:G3,:F3,:E3,:F3,:D3,:G3,:C3,:A2,:B2,:G2,:D3,:B2,:C3,:D3,:G2,:r,:C4,:A2,:B2,:C3,:D3,:D3,:E3,:Fs3,:G3,:E3,:Fs3,:G3,:A3,:A2,:B2,:C3,:D3,:A2,:B2,:C3,:D3,:E3,:C3,:D3,:G2,:G3,:G2,:C3,:E3,:D3,:G3,:F3,:E3,:D3,:C3,:E3,:D3,:C3,:D3,:E3,:C3,:D3,:G2,:G3,:G2,:C3,:C3,:D3,:G3,:G2,:C3,:D3,:E3,:D3,:C3,:B2,:C3,[:D3,:A3],:G2,:G3,:G3,:C3,:C3,:D3,:r,:Fs4,:G3,:G3,:F3,:E3,:C3,[:D3,:A3,:D4],:G2,:G3,:G3,:C3,:C3,:D3,:D3,:G3,:G3,:F3,:F3,:E3,:C3]
b4[0]=[2.0,1.0,1.0,2.0,2.0,2.0,2.0,1.0,1.0,1.0,1.0,2.0,0.5,0.5,0.5,0.5,1.0,1.0,1.0,0.5,0.5,1.0,0.5,0.5,1.0,1.0,0.5,0.5,1.0,2.0,2.0,1.0,1.0,2.0,2.0,1.0,1.0,1.0,1.0,2.0,2.0,2.0,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,1.0,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,1.0,1.0,2.0,2.0,1.0,1.0,1.0,1.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,2.0,1.0,1.0,1.0,1.0,2.0,2.0,2.0,1.0,1.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,0.5,0.5,1.0,2.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.5,0.5,2.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,2.0,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,1.0,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,2.0,2.0,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,2.0,1.0,1.0,1.0,1.0,2.0,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,1.0,1.0,1.0,1.0,2.0,1.0,1.0,1.0,1.0,2.0,1.0,1.0,0.75,0.25,1.0,1.0,0.5,0.5,1.0,1.0,2.0,1.0,1.0,1.0,1.0,1.0,0.5,0.5,1.0,1.0,2.0,1.0,1.0,2.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0]
a4[1]=[:D3,:G2,:r]
b4[1]=[2.0,2.0,2.0]
c4=[100,80]
in_thread do
   for i in st..a4.length-1
     in_thread do
       bosc 3,a4[i],b4[i],s[3],r[3],synth[3],c4[i],amp[3]*qt,:cont3,-2
     end
     sync :cont3
   end
 end

a5=[]
b5=[]
a5[0]=[:r,:r,:r,:Fs4,:r,:r,:D3,:r,:r]
b5[0]=[55*4,3.0,0.5,0.5,4,3.0,1.0,5*4,2.0]
a5[1]=[:r,:r]
b5[1]=[2.0,4]
c5=[100,80]
in_thread do
   for i in st..a5.length-1
     in_thread do
       bosc 4,a5[i],b5[i],s[4],r[4],synth[4],c5[i],amp[4]*qt,:cont4,-7
     end
     sync :cont4
   end
 end
